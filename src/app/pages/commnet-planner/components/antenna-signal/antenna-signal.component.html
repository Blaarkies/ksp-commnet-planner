<svg class="signal-line" xmlns="http://www.w3.org/2000/svg">
  <line
    [attr.stroke-width]="2"
    [attr.stroke]="signal.colorTotal + 'A'"
    [attr.x1]="worldViewScale * signal.nodes[0].location.x + inverseScaleSig() * signal.offsetVector.x + '%'"
    [attr.y1]="worldViewScale * signal.nodes[0].location.y + inverseScaleSig() * signal.offsetVector.y + '%'"
    [attr.x2]="worldViewScale * signal.nodes[1].location.x + inverseScaleSig() * signal.offsetVector.x + '%'"
    [attr.y2]="worldViewScale * signal.nodes[1].location.y + inverseScaleSig() * signal.offsetVector.y + '%'"
  />

  <ng-container *ngIf="signal.strengthRelay">
    <defs>
      <pattern
        [attr.id]="'pattern' + signal.id"
        patternUnits="userSpaceOnUse"
        width="10"
        height="10"
        [attr.patternTransform]="'rotate(' + (signal.angleDeg + 90) + ')'"
      >
        <line
          class="animate-data-travelling"
          x1="0" y1="2.5" x2="10" y2="2.5"
          [attr.stroke]="signal.colorRelay + 'A'"
          stroke-width="5"
        ></line>
      </pattern>
    </defs>

    <line
      [attr.stroke-width]="3"
      [attr.stroke]="'url(#pattern' + signal.id + ')'"
      [attr.x1]="worldViewScale * signal.nodes[0].location.x - inverseScaleSig() * signal.offsetVector.x + '%'"
      [attr.y1]="worldViewScale * signal.nodes[0].location.y - inverseScaleSig() * signal.offsetVector.y + '%'"
      [attr.x2]="worldViewScale * signal.nodes[1].location.x - inverseScaleSig() * signal.offsetVector.x + '%'"
      [attr.y2]="worldViewScale * signal.nodes[1].location.y - inverseScaleSig() * signal.offsetVector.y + '%'"
    />
  </ng-container>

  <foreignObject
    width="100%"
    height="100%"
    class="signal-strength"
    [attr.x]="worldViewScale * signal.textLocation.x + '%'"
    [attr.y]="worldViewScale * signal.textLocation.y + '%'"
  >
    <span
      xmlns="http://www.w3.org/1999/xhtml"
      @fade
      *ngIf="showText$ | async"
      class="distance-text"
    >
      {{signal.strengthTotal * 100 | number : '.0-0'}}%
      &nbsp;
      {{signal.displayDistance}}
    </span>
  </foreignObject>
</svg>
